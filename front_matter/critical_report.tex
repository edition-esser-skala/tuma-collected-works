\documentclass[changelog=false,tocdir=\tocdir]{ees}

\usepackage{mfirstuc}
\usepackage{multicol}

\ifthenelse{\equal{\MetadataFirstname}{(unknown)}}{\firstname{František Ignác Antonín}}{}
\ifthenelse{\equal{\MetadataLastname}{(unknown)}}{\lastname{Tůma}}{}
\shortname{\rlap{\hspace{.85em}°}Tuma}
\shorttitle{Collected works}

\ifthenelse{\isundefined{\MetadataFestival}}{%
  \subtitle{%
    \MetadataSubtitle\\[\baselineskip]%
    \xmakefirstuc{\MetadataGenre}%
  }%
}{%
  \subtitle{%
    \MetadataSubtitle\\[\baselineskip]%
    \xmakefirstuc{\MetadataGenre}~(\MetadataFestival)%
  }%
}

\makeatletter
\providecommand\MetadataTocstyle{none}
\ifthenelse{\equal{\MetadataTocstyle}{none}}{%
  \let\ees@tocstyle\ees@tocstyle@none%
  \renewcommand\newtocentry[6]{%
    \bookmark[level=#2,dest=score.#6]{#5}%
  }%
}{}

\ifthenelse{\isundefined{\MetadataEnlargefirstpage}}{}{\ees@enlargefirstpagetrue}

\ifthenelse{\isundefined{\MetadataToe}}{\ees@toefalse}{}

\ifthenelse{\isundefined{\MetadataAbbrwidth}}{}{\let\ees@abbrwidth\MetadataAbbrwidth}

\providecommand\MetadataCommentary{}

\providecommand\MetadataLyrics{}
\ifthenelse{\equal{\MetadataLyrics}{\@empty}}{%
  \def\lyrics{}%
}{%
  \def\lyrics{\section{Lyrics}\MetadataLyrics}%
}

\providecommand\MetadataAcknowledgements{}
\ifthenelse{\equal{\MetadataAcknowledgements}{\@empty}}{%
  \def\acknowledgements{}%
}{%
  \def\acknowledgements{\section{Acknowledgements}\MetadataAcknowledgements}%
}

\def\eesCommentaryAfterToe{\MetadataCommentary\lyrics\acknowledgements}%
\makeatother


\begin{document}

\eesTitlePage

\eesCriticalReport{\csname MetadataToe\endcsname}

\eesToc{}

\eesScore

\end{document}
